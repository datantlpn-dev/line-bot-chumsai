# ЁЯУН LINE Bot р╕Др╣Йр╕Щр╕лр╕▓р╕Кр╕╕р╕бр╕кр╕▓р╕вр╣Гр╕Бр╕ер╣Йр╣Ар╕Др╕╡р╕вр╕З

р╕гр╕░р╕Ър╕Ър╕Др╣Йр╕Щр╕лр╕▓р╕Кр╕╕р╕бр╕кр╕▓р╕вр╣Гр╕Бр╕ер╣Йр╣Ар╕Др╕╡р╕вр╕Зр╕Ир╕▓р╕Бр╕Юр╕┤р╕Бр╕▒р╕Фр╕Чр╕╡р╣Ир╕Ьр╕╣р╣Йр╣Гр╕Кр╣Йр╕кр╣Ир╕Зр╕бр╕▓ р╣Бр╕кр╕Фр╕Зр╕Ьр╕ер╕лр╕ер╕▓р╕вр╕Кр╕╕р╕бр╕кр╕▓р╕вр╣Гр╕Щр╕гр╕▒р╕ир╕бр╕╡ 5 р╕Бр╕б. р╕Юр╕гр╣Йр╕нр╕б Flex Message р╕кр╕зр╕вр╕Зр╕▓р╕б

## ЁЯЪА р╕Яр╕╡р╣Ар╕Ир╕нр╕гр╣М

- тЬЕ р╕гр╕▒р╕Ър╕Юр╕┤р╕Бр╕▒р╕Ф (Location) р╕Ир╕▓р╕Бр╕Ьр╕╣р╣Йр╣Гр╕Кр╣Й
- тЬЕ р╕Др╕│р╕Щр╕зр╕Ур╕гр╕░р╕вр╕░р╕Чр╕▓р╕Зр╕Фр╣Йр╕зр╕вр╕кр╕╣р╕Хр╕г Haversine
- тЬЕ р╕Др╣Йр╕Щр╕лр╕▓р╕Кр╕╕р╕бр╕кр╕▓р╕вр╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Фр╣Гр╕Щр╕гр╕▒р╕ир╕бр╕╡ **5 р╕Бр╕б.** р╕Ир╕▓р╕Б Google Sheets
- тЬЕ р╣Бр╕кр╕Фр╕Зр╕кр╕╣р╕Зр╕кр╕╕р╕Ф **5 р╕Кр╕╕р╕бр╕кр╕▓р╕вр╣Гр╕Бр╕ер╣Йр╕Чр╕╡р╣Ир╕кр╕╕р╕Ф** р╕Юр╕гр╣Йр╕нр╕бр╕гр╕░р╕вр╕░р╕Чр╕▓р╕Зр╣Бр╕ер╕░р╕Ир╕│р╕Щр╕зр╕Щр╕Ир╕╕р╕Ф
- тЬЕ р╕Ыр╕╕р╣Ир╕бр╣Ар╕Ыр╕┤р╕Ф Google My Maps р╕кр╕│р╕лр╕гр╕▒р╕Ър╣Бр╕Хр╣Ир╕ер╕░р╕Кр╕╕р╕бр╕кр╕▓р╕в
- тЬЕ р╕Цр╣Йр╕▓р╣Др╕бр╣Ир╣Ар╕Ир╕нр╕Кр╕╕р╕бр╕кр╕▓р╕вр╣Гр╕Щр╕гр╕▒р╕ир╕бр╕╡ р╕Ир╕░р╣Бр╕кр╕Фр╕Зр╕Ыр╕╕р╣Ир╕бр╣Ар╕Ыр╕┤р╕Фр╣Бр╕Ьр╕Щр╕Чр╕╡р╣Ир╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Ф

## ЁЯУЛ р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Бр╕▓р╕гр╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕З

### 1. р╣Ар╕Хр╕гр╕╡р╕вр╕б Google Sheets

1. р╕кр╕гр╣Йр╕▓р╕З Google Sheets р╣Гр╕лр╕бр╣И р╕Юр╕гр╣Йр╕нр╕бр╕Др╕нр╕ер╕▒р╕бр╕Щр╣М:
   - `chumsa` = р╕Кр╕╖р╣Ир╕нр╕Кр╕╕р╕бр╕кр╕▓р╕в (р╣Ар╕Кр╣Ир╕Щ "р╕ер╕╡р╣Й", "р╕кр╕лр╕Юр╕▒р╕Тр╕Щр╣М OLTC")
   - `lat` = р╕ер╕░р╕Хр╕┤р╕Ир╕╣р╕Ф (р╣Ар╕Кр╣Ир╕Щ 18.540096)
   - `lng` = р╕ер╕нр╕Зр╕Ир╕┤р╕Ир╕╣р╕Ф (р╣Ар╕Кр╣Ир╕Щ 99.01961)

   **р╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕е:**
   ```
   | chumsa         | lat       | lng       |
   |----------------|-----------|-----------|
   | р╕ер╕╡р╣Й            | 17.802933 | 98.948767 |
   | р╕кр╕лр╕Юр╕▒р╕Тр╕Щр╣М OLTC   | 18.540096 | 99.01961  |
   | р╕Ыр╣Ир╕▓р╣Ар╕кр╣Йр╕▓        | 18.623920 | 99.038829 |
   ```

2. р╕кр╕гр╣Йр╕▓р╕З Service Account:
   - р╣Др╕Ыр╕Чр╕╡р╣И [Google Cloud Console](https://console.cloud.google.com/)
   - р╣Ар╕Ыр╕┤р╕Ф project р╕лр╕гр╕╖р╕нр╕кр╕гр╣Йр╕▓р╕Зр╣Гр╕лр╕бр╣И
   - р╣Ар╕Ыр╕┤р╕Ф **Google Sheets API** р╣Бр╕ер╕░ **Google Drive API**
   - р╣Др╕Ыр╕Чр╕╡р╣И **APIs & Services > Credentials**
   - р╕Др╕ер╕┤р╕Б **Create Credentials > Service Account**
   - р╕Фр╕▓р╕зр╕Щр╣Мр╣Вр╕лр╕ер╕Фр╣Др╕Яр╕ер╣М JSON (р╕Бр╕╕р╕Нр╣Бр╕И)

3. р╣Бр╕Кр╕гр╣М Google Sheets:
   - р╣Ар╕Ыр╕┤р╕Фр╕нр╕╡р╣Ар╕бр╕ер╕Ир╕▓р╕Бр╣Др╕Яр╕ер╣М JSON (field: `client_email`)
   - р╣Бр╕Кр╕гр╣Мр╣Др╕Яр╕ер╣М Sheets р╣Гр╕лр╣Йр╕нр╕╡р╣Ар╕бр╕ер╕Щр╕▒р╣Йр╕Щр╕бр╕╡р╕кр╕┤р╕Чр╕Шр╕┤р╣М **Viewer**

### 2. р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓ LINE Bot

1. р╣Др╕Ыр╕Чр╕╡р╣И [LINE Developers Console](https://developers.line.biz/)
2. р╕кр╕гр╣Йр╕▓р╕З Provider р╣Бр╕ер╕░ Messaging API Channel
3. р╕Др╕▒р╕Фр╕ер╕нр╕Б:
   - **Channel Access Token** (Long-lived)
   - **Channel Secret**

### 3. Deploy р╕Ър╕Щ Vercel

1. Push р╣Вр╕Др╣Йр╕Фр╕Вр╕╢р╣Йр╕Щ GitHub
2. р╣Др╕Ыр╕Чр╕╡р╣И [Vercel](https://vercel.com/)
3. Import project р╕Ир╕▓р╕Б GitHub
4. р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓ **Environment Variables**:
   ```
   LINE_CHANNEL_ACCESS_TOKEN=xxx
   LINE_CHANNEL_SECRET=xxx
   GOOGLE_SHEET_ID=xxx (р╕Ир╕▓р╕Б URL р╕Вр╕нр╕З Google Sheets)
   GOOGLE_CREDENTIALS_JSON={"type":"service_account",...}
   ```
5. Deploy!

### 4. р╣Ар╕Кр╕╖р╣Ир╕нр╕бр╕Хр╣Ир╕н Webhook

1. р╕Др╕▒р╕Фр╕ер╕нр╕Б URL р╕Ир╕▓р╕Б Vercel (р╣Ар╕Кр╣Ир╕Щ `https://your-project.vercel.app`)
2. р╣Др╕Ыр╕Чр╕╡р╣И LINE Developers Console
3. р╣Гр╕кр╣И Webhook URL: `https://your-project.vercel.app/api/webhook`
4. р╣Ар╕Ыр╕┤р╕Ф **Use webhook** р╣Бр╕ер╕░ **Auto-reply messages**

## ЁЯзк р╕Чр╕Фр╕кр╕нр╕Ъ

1. р╣Ар╕Юр╕┤р╣Ир╕бр╕Ър╕нр╕Чр╣Ар╕Ыр╣Зр╕Щр╣Ар╕Юр╕╖р╣Ир╕нр╕Щр╕Ьр╣Ир╕▓р╕Щ QR Code
2. р╕кр╣Ир╕Зр╕Юр╕┤р╕Бр╕▒р╕Ф (Location) р╣Гр╕лр╣Йр╕Ър╕нр╕Ч
3. р╕Ър╕нр╕Чр╕Ир╕░р╕Хр╕нр╕Ър╕Бр╕ер╕▒р╕Ър╕Кр╕╕р╕бр╕кр╕▓р╕вр╣Гр╕Бр╕ер╣Йр╣Ар╕Др╕╡р╕вр╕Зр╕ар╕▓р╕вр╣Гр╕Щр╕гр╕▒р╕ир╕бр╕╡ 5 р╕Бр╕б.!

## тЪЩя╕П р╕Бр╕▓р╕гр╕Ыр╕гр╕▒р╕Ър╣Бр╕Хр╣Ир╕З

р╕Др╕╕р╕Ур╕кр╕▓р╕бр╕▓р╕гр╕Цр╣Бр╕Бр╣Йр╣Др╕Вр╕Др╣Ир╕▓р╕Др╕Зр╕Чр╕╡р╣Ир╣Гр╕Щ `app.py`:

```python
SEARCH_RADIUS_KM = 5        # р╕гр╕▒р╕ир╕бр╕╡р╕Бр╕▓р╕гр╕Др╣Йр╕Щр╕лр╕▓ (р╕Бр╕б.)
MAX_RESULTS = 5             # р╕Ир╕│р╕Щр╕зр╕Щр╕Кр╕╕р╕бр╕кр╕▓р╕вр╕кр╕╣р╕Зр╕кр╕╕р╕Фр╕Чр╕╡р╣Ир╣Бр╕кр╕Фр╕З
GOOGLE_MY_MAPS_URL = "..."  # URL р╕Вр╕нр╕З Google My Maps
```

## ЁЯЫая╕П р╣Вр╕Др╕гр╕Зр╕кр╕гр╣Йр╕▓р╕Зр╣Вр╕Др╣Йр╕Ф

```
тФЬтФАтФА app.py              # р╣Вр╕Др╣Йр╕Фр╕лр╕ер╕▒р╕Б Flask + LINE Bot
тФЬтФАтФА vercel.json         # р╕Бр╕▓р╕гр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓ Vercel
тФЬтФАтФА requirements.txt    # Python dependencies
тФФтФАтФА README.md          # р╣Ар╕нр╕Бр╕кр╕▓р╕гр╕Щр╕╡р╣Й
```

## ЁЯУЭ р╕лр╕бр╕▓р╕вр╣Ар╕лр╕Хр╕╕

- р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Кр╕╖р╣Ир╕нр╕Др╕нр╕ер╕▒р╕бр╕Щр╣Мр╣Гр╕Щ Google Sheets р╣Гр╕лр╣Йр╕Хр╕гр╕Зр╕Бр╕▒р╕Ър╣Вр╕Др╣Йр╕Ф
- р╕лр╕▓р╕Бр╕бр╕╡р╕Ыр╕▒р╕Нр╕лр╕▓ р╕Фр╕╣ Vercel Logs: `Deployments > [Project] > Functions > [Log]`
- Webhook URL р╕Хр╣Йр╕нр╕Зр╣Ар╕Ыр╣Зр╕Щ HTTPS р╣Ар╕Чр╣Ир╕▓р╕Щр╕▒р╣Йр╕Щ

## ЁЯРЫ р╣Бр╕Бр╣Йр╣Др╕В Error р╕Чр╕╡р╣Ир╕Юр╕Ър╕Ър╣Ир╕нр╕в

### `TypeError: issubclass() arg 1 must be a class`
- р╣Гр╕Кр╣Йр╣Др╕Яр╕ер╣М `vercel.json` р╕Чр╕╡р╣Ир╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕З (р╕Фр╕╣р╕Фр╣Йр╕▓р╕Щр╕Ър╕Щ)
- р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ Python version р╣Гр╕Щ Vercel р╕Хр╣Йр╕нр╕Зр╣Ар╕Ыр╣Зр╕Щ 3.9+

### р╕Ър╕нр╕Чр╣Др╕бр╣Ир╕Хр╕нр╕Ъ
- р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ Environment Variables р╣Гр╕Щ Vercel
- р╕Фр╕╣ Logs р╣Гр╕Щ Vercel
- р╕Чр╕Фр╕кр╕нр╕Ъ Webhook р╕Фр╣Йр╕зр╕в LINE Verify button

### р╣Др╕бр╣Ир╣Ар╕Ир╕нр╕Вр╣Йр╕нр╕бр╕╣р╕е Google Sheets
- р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓р╣Бр╕Кр╕гр╣Мр╣Др╕Яр╕ер╣Мр╣Гр╕лр╣Й Service Account Email р╣Бр╕ер╣Йр╕з
- р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ GOOGLE_SHEET_ID р╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕З
- р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Кр╕╖р╣Ир╕нр╕Др╕нр╕ер╕▒р╕бр╕Щр╣Мр╕Хр╕гр╕Зр╕Бр╕▒р╕Ър╣Вр╕Др╣Йр╕Ф

## ЁЯУЮ р╕Хр╕┤р╕Фр╕Хр╣Ир╕н

р╕лр╕▓р╕Бр╕бр╕╡р╕Ыр╕▒р╕Нр╕лр╕▓р╕лр╕гр╕╖р╕нр╕Вр╣Йр╕нр╕кр╕Зр╕кр╕▒р╕в р╕кр╕▓р╕бр╕▓р╕гр╕Цр╣Ар╕Ыр╕┤р╕Ф Issue р╣Гр╕Щ GitHub р╣Др╕Фр╣Йр╣Ар╕ер╕в!
